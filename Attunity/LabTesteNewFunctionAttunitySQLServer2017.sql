


use
I4Pro_ERP_Icatu
GO

declare @P1 varchar(25),@P2 varchar(23)

select /* top 50000 */
	[Current LSN],
	[operation],
	[Context],
	[Transaction ID],
	[Transaction Name],
	[Begin Time],
	[End Time],
	[Flag Bits],
	[PartitionID],
	[Page ID],
	[Slot ID],
	[RowLog Contents 0],
	[Log Record],
	[RowLog Contents 1] -- After Image
from sys.fn_dump_dblog (@P1, NULL,NULL, 1,'X:\LOG_ATTUNITY\I4Pro_ERP_Icatu_backup_2020_11_24_165503_0468341.trn',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL)
where [Current LSN] collate SQL_Latin1_General_CP1_CI_AS >= @P2 collate SQL_Latin1_General_CP1_CI_AS
and
(
  (  [operation] in ('LOP_BEGIN_XACT','LOP_COMMIT_XACT','LOP_ABORT_XACT') )
  or
  (  [operation] in ('LOP_INSERT_ROWS','LOP_DELETE_ROWS','LOP_MODIFY_ROW')
     and
     --[context]   in ('LCX_HEAP','LCX_CLUSTERED','LCX_MARK_AS_GHOST' /*,'LCX_TEXT_MIX'*/)
     ( ( [context]   in ('LCX_HEAP','LCX_CLUSTERED','LCX_MARK_AS_GHOST') ) or ([context] = 'LCX_TEXT_MIX'))
     and
     [PartitionID] in (72057701588664320,72057701587746816,72057701587353600,72057662033952768,72057629745545216,72057629748297728,72057629757014016,72057640382562304,72057662034870272,72057701591220224,72057705501360128,72057629753540608,72057624325914624,72057629746659328,72057684952678400,72057662036967424,72057662037426176,72057721318998016,72057692899508224,72057717281193984,72057629746724864,72057732170711040,72057684950188032,72057622735093760,72057629749280768,72057622752329728,72057629768548352,72057703799980032,72057703807582208,72057701590499328,72057629755768832,72057703800373248,72057629760552960,72057629769596928,72057629741809664,72057703800176640,72057629757145088,72057732172677120,72057732173594624,72057662031527936,72057701581717504,72057701582635008,72057732169596928,72057703792508928,72057629742923776,72057629746200576,72057629747118080,72057629760094208,72057662028513280,72057629752164352,72057662028251136)
  )
  or
  ([operation] = 'LOP_HOBT_DDL')
)


-- Better Performance Time Execution Improvement

set statistics time on

declare @P1 varchar(25),@P2 varchar(23)

select /* top 50000 */
	[Current LSN],
	[operation],
	[Context],
	[Transaction ID],
	[Transaction Name],
	[Begin Time],
	[End Time],
	[Flag Bits],
	[PartitionID],
	[Page ID],
	[Slot ID],
	[RowLog Contents 0],
	[Log Record],
	[RowLog Contents 1] -- After Image
from sys.fn_full_dblog(NULL,NULL,DB_ID(),NULL,NULL,NULL,NULL,'X:\LOG_ATTUNITY\I4Pro_ERP_Icatu_backup_2020_11_24_165503_0468341.trn')
where [Current LSN] collate SQL_Latin1_General_CP1_CI_AS >= @P2 collate SQL_Latin1_General_CP1_CI_AS
and
(
  (  [operation] in ('LOP_BEGIN_XACT','LOP_COMMIT_XACT','LOP_ABORT_XACT') )
  or
  (  [operation] in ('LOP_INSERT_ROWS','LOP_DELETE_ROWS','LOP_MODIFY_ROW')
     and
     --[context]   in ('LCX_HEAP','LCX_CLUSTERED','LCX_MARK_AS_GHOST' /*,'LCX_TEXT_MIX'*/)
     ( ( [context]   in ('LCX_HEAP','LCX_CLUSTERED','LCX_MARK_AS_GHOST') ) or ([context] = 'LCX_TEXT_MIX'))
     and
     [PartitionID] in (72057701588664320,72057701587746816,72057701587353600,72057662033952768,72057629745545216,72057629748297728,72057629757014016,72057640382562304,72057662034870272,
	 72057701591220224,72057705501360128,72057629753540608,72057624325914624,72057629746659328,72057684952678400,72057662036967424,72057662037426176,72057721318998016,72057692899508224,
	 72057717281193984,72057629746724864,72057732170711040,72057684950188032,72057622735093760,72057629749280768,72057622752329728,72057629768548352,72057703799980032,72057703807582208,
	 72057701590499328,72057629755768832,72057703800373248,72057629760552960,72057629769596928,72057629741809664,72057703800176640,72057629757145088,72057732172677120,72057732173594624,
	 72057662031527936,72057701581717504,72057701582635008,72057732169596928,72057703792508928,72057629742923776,72057629746200576,72057629747118080,72057629760094208,72057662028513280,
	 72057629752164352,72057662028251136)
  )
  or
  ([operation] = 'LOP_HOBT_DDL')
)

GO
